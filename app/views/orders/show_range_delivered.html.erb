<% if @current_user.role == "owner" %>
<div class="checkout-container">
  <div class="all-or-container">

    <% @user = User.find(params[:user_id]) %>
    <% m = params[:m].to_i %>
    <% year = params[:year].to_i %>

    <% @ordered_by = "#{@user.first_name} #{@user.last_name} (#{@user.email})" %>
    <% @o = Order.delivered.where("walk_in_customer = ? OR user_id = ?", @ordered_by, params[:user_id]) %>
    <% @orders = @o.where("date_part('month', delivered_on) = ? AND date_part('year', delivered_on) = ?", m, year).order("delivered_on DESC") %>

    <!-- Section for pending -->
    <%= render partial: "all-orders-section", locals: {
                 title: "#{@user.first_name}'s Online delivered Orders for: #{m}/#{year}",
                 orders: @orders.online,
                 status: "delivered",
                 role: @current_user.role,
               } %>
    <!-- End  -->

    <!-- Section for delivered -->
    <%= render partial: "all-orders-section", locals: {
                 title: "#{@user.first_name}'s walk-in Delivered Orders for: #{m}/#{year}",
                 orders: @orders.walk_in,
                 status: "delivered",
                 role: @current_user.role,
               } %>
    <!-- End  -->

  </div>
  <div class="orders-goback">
    <%= button_to "Reverte!", sales_report_path(:id => m), params: { :year => year }, method: "get", class: "button" %>
  </div>

</div>

<% else %>
  <% flash[:error] = "You do not have access to this page" %>
  <div class="checkout-container">
    <div class="all-or-container">
      <%= button_to "Reverte!", shops_path, method: "get", class: "button" %>
    </div>
  </div>
<% end %>
